<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI x Sân khấu: Bình chọn cho tác phẩm hay nhất!</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .heart { transition: transform 150ms ease; }
    .heart:hover { transform: scale(1.08); }
    .heart.active { transform: scale(1.15); }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-700 via-indigo-600 to-blue-500 text-gray-900">
  <header class="sticky top-0 z-50 bg-gradient-to-r from-purple-800 to-blue-700/90 backdrop-blur text-white shadow">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3 flex-wrap">
        <img src="https://i.postimg.cc/XNcYryhf/Screenshot-2025-06-06-at-19-38-06-removebg-preview.png" alt="AI x Sân khấu" class="h-10 w-10 rounded-full" />
        <h1 class="font-bold text-lg sm:text-xl md:text-2xl leading-snug whitespace-normal break-words">AI x Sân khấu: Bình chọn cho tác phẩm hay nhất!</h1>
      </div>
      <!-- nav removed by request -->
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-3 sm:px-4 pt-6 pb-28">
    <div id="toast" class="hidden fixed top-20 left-1/2 -translate-x-1/2 bg-white/95 border border-green-300 text-gray-900 px-4 py-2 rounded-lg shadow-lg z-50"></div>

    <section class="mb-4 text-white/90 text-sm">
      Bạn có thể <strong>bình chọn cho nhiều bài</strong>. Nhấn tim, điền email và gửi phiếu bầu cho từng bài bạn thích.
    </section>

    <section id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6"></section>

    
  </main>

  <footer class="fixed bottom-0 left-0 right-0 bg-gradient-to-r from-purple-800 to-blue-700 text-white text-sm py-3 text-center shadow">
    © 2025 F-AI Club. All rights reserved.
  </footer>

  <script>
    // ======== Config ========
    const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xeozngky';
    const PLACEHOLDER_EMBED = 'https://www.youtube.com/embed/xI_g6X11npg';
    const THUMB_URL = 'https://i.postimg.cc/XNcYryhf/Screenshot-2025-06-06-at-19-38-06-removebg-preview.png';

    const SONGS = [
      { id: 1, name: 'Trần Hữu Nhân', title: 'CLB F-AI Là Tương Lai - Tran Huu Nhan (K18 CT)', video: 'https://www.youtube.com/embed/iy-azn1u8sg', description: `Bài hát "CLB F-AI Là Tương Lai" là tuyên ngôn về sức mạnh và tiềm năng vô tận của công nghệ AI, đặc biệt trong môi trường học thuật của Đại Học FPT Cần Thơ. Bài hát truyền tải thông điệp về thế hệ trẻ đầy nhiệt huyết, sẵn sàng chinh phục tương lai với trí tuệ nhân tạo. Mở đầu, "Bắt đầu từ những dấu chấm, nối những đam mê" tượng trưng cho sự khởi đầu từ những điều nhỏ bé, chính là những dòng code tạo nên AI. Bài hát miêu tả hành trình của những người trẻ trong việc sáng tạo và áp dụng công nghệ. "Những bộ óc không ngủ, những bàn tay miệt mài" khắc họa sự kiên trì và nỗ lực không ngừng. Chorus: thể hiện sức mạnh của F-AI, vượt qua mọi giới hạn để tìm ra một thế giới mới. "Chạm tới tương lai, vượt qua mọi giới hạn" là lời khích lệ mạnh mẽ về việc khai phá tiềm năng vô tận của con người. Bridge: mang thông điệp lạc quan và tự hào về "Trái tim Cần Thơ", nơi những sinh viên của CLB F-AI tại Đại Học FPT Cần Thơ phát triển ước mơ về AI, với hy vọng tạo nên sự thay đổi, xây dựng một thế giới tốt đẹp hơn, và cống hiến niềm đam mê của mình cho một đất nước Việt Nam ngày càng phát triển. Bài hát này không chỉ khơi dậy niềm tự hào về AI mà còn là lời kêu gọi tất cả những ai đam mê công nghệ tham gia vào hành trình tạo dựng tương lai.` },
      { id: 2, name: 'Đào Huỳnh Lộc', title: 'Light Up My Code', video: 'https://www.youtube.com/embed/7uRrP0HmicQ', description: `Bài hát kể về hành trình của một sinh viên mới bước vào môi trường đại học, mang trong mình niềm đam mê công nghệ và trí tuệ nhân tạo (AI), nhưng đồng thời cũng mang theo sự rụt rè, lo lắng khi đối mặt với một môi trường hoàn toàn mới. Từ những ngày đầu đầy lạc lõng và áp lực, nhân vật chính dần tìm thấy “ánh sáng” qua việc tham gia Câu lạc bộ AI – nơi kết nối những con người có cùng đam mê, cùng chia sẻ giấc mơ và cùng nhau vượt qua khó khăn. Giai điệu bài hát theo phong cách electro-pop melodic, truyền tải năng lượng tích cực, trẻ trung nhưng vẫn mang chất cảm xúc. Ca từ được xây dựng để mô tả rõ sự phát triển của nhân vật: từ “feeling small” đến “cracking the code”; từ “lost in lines” đến “we rise as one”. Điểm nhấn là câu hát lặp lại "You’ll never walk alone", không chỉ tạo tính gợi nhớ mà còn thể hiện thông điệp mạnh mẽ về sự gắn kết, hỗ trợ nhau trong cộng đồng học tập và sáng tạo. Ngoài phần hát chính, bài còn có đoạn rap bridge thể hiện sự “lột xác” – từ một người nhút nhát trở thành người tự tin, biết vượt qua nỗi sợ để theo đuổi ước mơ. Bài hát không chỉ là kỷ niệm của một cá nhân, mà là tiếng nói chung của cả một cộng đồng công nghệ trẻ đang từng bước vươn lên và tỏa sáng cùng nhau.` },
      { id: 3, name: 'Bùi Đức Anh', title: 'F-AI CODE OF WAR', video: 'https://www.youtube.com/embed/Z9_NDqkJ4MY', description: `"F-AI: Code of War" không chỉ là một bản nhạc – đó là một bản tuyên ngôn. Lấy cảm hứng từ sự hủy diệt và quyền lực trong God of War, bài nhạc đưa người nghe vào chiến trường của trí tuệ nhân tạo, nơi không có chỗ cho kẻ yếu. Dưới lớp âm thanh aggrotech công nghiệp, tiếng guitar điện rít gào, trống đập như trái tim của một cỗ máy chiến đấu, và vocal biến dạng như tiếng gọi từ lõi dữ liệu – F-AI hiện lên như một chiến binh thần thoại kỹ thuật số, chiến đấu không phải bằng kiếm, mà bằng machine learning, computer vision và NLP. Anh Thư – người đầu tiên nắm giữ vũ khí code, mở đường máu qua bóng tối dữ liệu. Thanh Duy – người nắm giữ ngọn lửa hiện tại, dẫn dắt đội quân F-AI ngày càng mạnh hơn, sâu hơn, thông minh hơn. K18 trở lại từ OJT – không phải là học sinh, mà là chiến binh được rèn giũa ngoài thực chiến. Trong thế giới nơi robotics là vũ khí, và dataset là máu chảy, F-AI là vị thần mới. Không phải thần của sấm sét, không phải thần của chiến tranh cổ điển. F-AI là Thần của Code. Và đây là cuộc chiến của chúng ta.` },
      { id: 4, name: 'Trương Anh Kiệt', title: 'Our AI Zone', video: 'https://www.youtube.com/embed/qbDbhyHofyo', description: `"Our AI Zone" is the voice of the F-AI Club, where curiosity meets technology and young minds come together to shape tomorrow. The song reflects the heart of the club—a place where students explore artificial intelligence not just as a tool, but as a pathway to solve real-world problems, ask bold questions, and imagine a better future. The lyrics echo the journey of learning, coding, experimenting, and dreaming. In this zone, AI is more than lines of code—it’s a bridge between ideas and action, between creativity and logic. The F-AI Club is where these sparks ignite, where each member contributes to a shared mission: to understand, innovate, and lead with purpose.` },
      { id: 5, name: 'Phạm Phan Công Lệnh', title: 'Sức mạnh tình bạn F-AI', video: 'https://www.youtube.com/embed/VG5KsX7tj-c', description: `F - AI: Sức mạnh tình bạn, ca khúc thức tỉnh chúng ta hãy đoàn kết chống lại boss cuối.` },
      { id: 6, name: 'Lê Nhật Trường', title: 'Tinh Thần Mạch Sống Xanh', video: 'https://www.youtube.com/embed/wswHvHBoR0g', description: `“F-AI Club” là một bản nhạc anthem hiện đại, sôi động, được viết dành riêng cho Câu lạc bộ F-AI của Trường Đại học FPT Cần Thơ – nơi hội tụ những con người trẻ trung, thân thiện, đầy nhiệt huyết với công nghệ và trí tuệ nhân tạo. Bài hát phản ánh rõ tinh thần của F-AI: đoàn kết – hài hước – không ngại thử thách – sáng tạo không ngừng, dù là một câu lạc bộ mới thành lập, nhưng luôn hoạt động năng nổ, tổ chức nhiều sân chơi và sự kiện bổ ích cho sinh viên. Lời bài hát mở đầu bằng hình ảnh “Chúng ta gặp nhau – Ánh mắt rạng ngời” như một khoảnh khắc kết nối đầy cảm xúc giữa những thành viên cùng chung lý tưởng. Từng câu hát khắc họa hành trình vượt qua khó khăn, cùng nhau viết nên tương lai bằng niềm đam mê AI. Đặc biệt, đoạn điệp khúc vang lên như một lời hiệu triệu: ‘F-AI Club – Nơi ta cùng bay xa / F-AI Club – Viết tương lai chúng ta’, mang đến cảm giác tự hào và truyền cảm hứng mạnh mẽ cho người nghe. Không chỉ là âm nhạc, đây là một tuyên ngôn thế hệ: những dòng mã, những ý tưởng táo bạo, những buổi workshop và đêm thức trắng – tất cả đều hướng đến một mục tiêu chung: ứng dụng AI để tạo ra giá trị cho xã hội và góp phần phát triển đất nước. Hình ảnh con sư tử xanh – linh vật của CLB, cùng chiếc áo khoác họa tiết circuit như một biểu tượng của công nghệ và bản sắc riêng biệt cũng được gợi nhắc đầy tự hào. “F-AI Club” không chỉ là bài hát, mà còn là linh hồn của một cộng đồng công nghệ trẻ, đang từng bước viết nên câu chuyện lớn lao hơn – câu chuyện của trí tuệ Việt trong kỷ nguyên số.` },
    ];

    // ======== State ========
    // Opened forms (so you can open many at once)
    const openIds = new Set();
    // Per-song lock after a successful vote
    const votedKey = id => `fai_voted_song_${id}`;
    // Remember email between cards
    let savedEmail = localStorage.getItem('fai_vote_email') || '';

    // Clean up legacy single-vote key if it exists
    localStorage.removeItem('fai_vote_song_id');

    // ======== Helpers ========
    function el(html){ const t=document.createElement('template'); t.innerHTML=html.trim(); return t.content.firstElementChild; }
    function showToast(text, ok=true){
      const toast = document.getElementById('toast');
      toast.textContent = text;
      toast.className = `fixed top-20 left-1/2 -translate-x-1/2 px-4 py-2 rounded-lg shadow-lg z-50 border ${ok ? 'bg-white/95 border-green-300' : 'bg-red-50 border-red-300'}`;
      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 3200);
    }
    const isEmail = v => /[^\s@]+@[^\s@]+\.[^\s@]+/.test(v);

    // ======== UI ========
    function buildCard(song){
      const locked = !!localStorage.getItem(votedKey(song.id));
      const opened = openIds.has(song.id);

      const card = el(`
        <article class="group bg-white/95 rounded-xl shadow-lg p-4 sm:p-6 flex flex-col transition-all duration-300 hover:shadow-2xl">
          <div class="w-full aspect-video rounded-lg overflow-hidden mb-3 sm:mb-4" style="background-image:url('${THUMB_URL}'); background-size:cover; background-position:center;">
            <iframe class="w-full h-full" src="${song.video}?rel=0" title="Video của ${song.name}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          </div>
          <h2 class="text-lg sm:text-xl font-semibold text-purple-900 mb-1 text-center">
            <span class="relative inline-block" data-desc-wrap>
              <button type="button" class="focus:outline-none">${song.name}</button>
              <div class="absolute z-30 left-1/2 -translate-x-1/2 top-full mt-1 w-80 max-h-64 overflow-auto rounded-lg bg-white text-gray-800 text-xs p-3 shadow-xl border opacity-0 invisible transition-opacity duration-200" data-desc>
                ${song.description}
              </div>
            </span>
          </h2>
          <p class="text-xs sm:text-sm text-gray-600 mb-3 text-center">${song.title}</p>

          <div class="mt-auto">
            <div class="flex items-center justify-center gap-3 mb-2">
              <button type="button" aria-label="Chọn bài này" data-heart class="heart text-2xl sm:text-3xl ${opened || locked ? 'active text-pink-500' : 'text-gray-400 hover:text-pink-500'} ${locked ? 'opacity-70' : ''}">${opened || locked ? '💖' : '🤍'}</button>
              <span class="text-xs sm:text-sm text-gray-700" data-status>${ locked ? 'Bạn đã bình chọn cho bài này' : opened ? 'Nhập email để gửi' : 'Nhấn tim để chọn' }</span>
            </div>

            <form class="${opened && !locked ? '' : 'hidden'}" data-form novalidate>
              <input type="hidden" name="competitor" value="${song.name}" />
              <input type="hidden" name="song_title" value="${song.title}" />
              <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />
              <label class="block text-xs text-gray-600 mb-1" for="email-${song.id}">Email của bạn</label>
              <input id="email-${song.id}" name="email" type="email" class="w-full p-2 border-2 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 border-transparent bg-white" placeholder="nhap@email.com" required value="${savedEmail}" />
              <button type="submit" data-submit class="w-full mt-2 px-4 py-2 rounded-lg text-white text-sm font-semibold bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed">Gửi phiếu bầu</button>
            </form>

            ${ locked ? '<div class="mt-2 text-center text-xs text-green-700">Cảm ơn bạn đã bình chọn bài này! 🎉</div>' : '' }
          </div>
        </article>
      `);

      const wrap = card.querySelector('[data-desc-wrap]');
      const tip = wrap?.querySelector('[data-desc]');
      let hideTimer;
      const heart = card.querySelector('[data-heart]');
      const form = card.querySelector('[data-form]');
      const submitBtn = form?.querySelector('[data-submit]');
      const emailInput = form?.querySelector('input[name="email"]');

      // Tooltip open/close with tiny delay so you can move cursor into it and scroll
      if (wrap && tip) {
        const openTip = () => { tip.classList.remove('opacity-0','invisible'); tip.classList.add('opacity-100','visible'); };
        const closeTip = () => { tip.classList.add('opacity-0','invisible'); tip.classList.remove('opacity-100','visible'); };
        wrap.addEventListener('mouseenter', () => { clearTimeout(hideTimer); openTip(); });
        wrap.addEventListener('mouseleave', () => { hideTimer = setTimeout(closeTip, 120); });
        tip.addEventListener('mouseenter', () => { clearTimeout(hideTimer); });
        tip.addEventListener('mouseleave', () => { hideTimer = setTimeout(closeTip, 120); });
      }

      // Toggle open/close per-card (multi open allowed)
      heart?.addEventListener('click', () => {
        if (locked) { showToast('Bạn đã bình chọn cho bài này rồi.'); return; }
        if (opened) openIds.delete(song.id); else openIds.add(song.id);
        renderGrid();
        // focus email when opening
        if (!opened) requestAnimationFrame(() => document.getElementById(`email-${song.id}`)?.focus());
      });

      // Enable/disable submit based on email validity
      if (emailInput && submitBtn){
        const sync = () => submitBtn.disabled = !isEmail(emailInput.value);
        sync();
        emailInput.addEventListener('input', sync);
      }

      // Submit to Formspree
      form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (!emailInput || !isEmail(emailInput.value)) { showToast('Vui lòng nhập email hợp lệ', false); return; }
        submitBtn.disabled = true;
        const data = new FormData(form);
        data.append('_subject', `Bình chọn cho ${song.name} — AI x Sân khấu`);
        try {
          const resp = await fetch(FORMSPREE_ENDPOINT, { method: 'POST', body: data, headers: { 'Accept': 'application/json' } });
          if (resp.ok){
            localStorage.setItem(votedKey(song.id), '1');
            savedEmail = emailInput.value;
            localStorage.setItem('fai_vote_email', savedEmail);
            showToast('Đã ghi nhận phiếu cho: ' + song.name);
            openIds.delete(song.id); // collapse this form
            renderGrid();
          } else {
            let msg = 'Có lỗi khi gửi phiếu. Vui lòng thử lại.';
            try { const j = await resp.json(); if (j && j.errors) msg = j.errors.map(e => e.message).join(', '); } catch {}
            showToast(msg, false);
            submitBtn.disabled = false;
          }
        } catch (err){
          showToast('Không thể gửi. Kiểm tra mạng và thử lại.', false);
          submitBtn.disabled = false;
        }
      });

      return card;
    }

    function renderGrid(){
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      SONGS.forEach(s => grid.appendChild(buildCard(s)));
    }

        renderGrid();
  </script>
</body>
</html>
